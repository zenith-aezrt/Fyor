--[[
    fyorUI Library v1.2 (Ultimate Fix)
    - Fix Draggable (Stable)
    - Fix Empty Tab (Auto-sync)
    - Fix Toggle Button (Responsive)
    - Modern Dark Theme
--]]

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Stats = game:GetService("Stats")

local LocalPlayer = Players.LocalPlayer

local WindUI = {
    CurrentTheme = {
        Accent = Color3.fromRGB(0, 85, 185), 
        Background = Color3.fromRGB(15, 15, 15),
        Secondary = Color3.fromRGB(25, 25, 25),
        Text = Color3.fromRGB(240, 240, 240),
        Border = Color3.fromRGB(40, 40, 40)
    },
    CurrentFont = Enum.Font.GothamMedium,
    ScreenGui = nil,
    NotifyGui = nil,
    Closed = false
}

-- // UTILS // --
local function Tween(obj, info, goal)
    local t = TweenService:Create(obj, TweenInfo.new(info.Time or 0.3, info.Style or Enum.EasingStyle.Quart, info.Dir or Enum.EasingDirection.Out), goal)
    t:Play()
    return t
end

local function MakeDraggable(dragPart, mainFrame)
    local dragging, dragStart, startPos
    dragPart.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end

-- // NOTIFICATION // --
function WindUI:Notify(title, text, duration)
    if not self.NotifyGui then
        self.NotifyGui = Instance.new("ScreenGui", CoreGui)
        self.NotifyGui.Name = "WindUI_Notifs"
        local holder = Instance.new("Frame", self.NotifyGui)
        holder.Name = "Holder"
        holder.Size = UDim2.new(0, 300, 1, 0)
        holder.Position = UDim2.new(1, -310, 0, 0)
        holder.BackgroundTransparency = 1
        Instance.new("UIListLayout", holder).VerticalAlignment = Enum.VerticalAlignment.Bottom
        Instance.new("UIPadding", holder).PaddingBottom = UDim.new(0, 20)
    end

    local nFrame = Instance.new("Frame", self.NotifyGui.Holder)
    nFrame.Size = UDim2.new(1, 0, 0, 70); nFrame.BackgroundColor3 = self.CurrentTheme.Background; nFrame.BorderSizePixel = 0
    Instance.new("UICorner", nFrame).CornerRadius = UDim.new(0, 8)
    local nStroke = Instance.new("UIStroke", nFrame); nStroke.Color = self.CurrentTheme.Border
    
    local accent = Instance.new("Frame", nFrame)
    accent.Size = UDim2.new(0, 3, 1, 0); accent.BackgroundColor3 = self.CurrentTheme.Accent; Instance.new("UICorner", accent)

    local tLbl = Instance.new("TextLabel", nFrame)
    tLbl.Text = title; tLbl.Size = UDim2.new(1, -20, 0, 25); tLbl.Position = UDim2.new(0, 15, 0, 5)
    tLbl.Font = Enum.Font.GothamBold; tLbl.TextColor3 = self.CurrentTheme.Text; tLbl.TextSize = 13; tLbl.BackgroundTransparency = 1; tLbl.TextXAlignment = "Left"

    local sLbl = Instance.new("TextLabel", nFrame)
    sLbl.Text = text; sLbl.Size = UDim2.new(1, -20, 0, 30); sLbl.Position = UDim2.new(0, 15, 0, 25)
    sLbl.Font = Enum.Font.GothamMedium; sLbl.TextColor3 = Color3.fromRGB(180, 180, 180); sLbl.TextSize = 11; sLbl.BackgroundTransparency = 1; sLbl.TextXAlignment = "Left"; sLbl.TextWrapped = true

    nFrame.Position = UDim2.new(1.5, 0, 0, 0)
    Tween(nFrame, {Time = 0.5}, {Position = UDim2.new(0, 0, 0, 0)})
    
    task.delay(duration or 4, function()
        Tween(nFrame, {Time = 0.5}, {Position = UDim2.new(1.5, 0, 0, 0)})
        task.wait(0.5)
        nFrame:Destroy()
    end)
end

-- // WINDOW CREATION // --
function WindUI:CreateWindow(title)
    if self.ScreenGui then self.ScreenGui:Destroy() end
    self.ScreenGui = Instance.new("ScreenGui", CoreGui)
    self.ScreenGui.Name = "fyor_UI_v1.2"
    self.ScreenGui.ResetOnSpawn = false

    local main = Instance.new("Frame", self.ScreenGui)
    main.Name = "MainFrame"
    main.Size = UDim2.new(0, 550, 0, 400)
    main.Position = UDim2.new(0.5, -275, 0.5, -200)
    main.BackgroundColor3 = self.CurrentTheme.Background
    main.BorderSizePixel = 0
    Instance.new("UICorner", main).CornerRadius = UDim.new(0, 12)
    Instance.new("UIStroke", main).Color = self.CurrentTheme.Border

    -- TopBar (Draggable)
    local topBar = Instance.new("Frame", main)
    topBar.Size = UDim2.new(1, 0, 0, 50)
    topBar.BackgroundTransparency = 1
    MakeDraggable(topBar, main)

    local titleLbl = Instance.new("TextLabel", topBar)
    titleLbl.Text = title:upper()
    titleLbl.Font = Enum.Font.GothamBold
    titleLbl.TextSize = 14
    titleLbl.TextColor3 = self.CurrentTheme.Text
    titleLbl.Position = UDim2.new(0, 15, 0, 0)
    titleLbl.Size = UDim2.new(0, 100, 1, 0)
    titleLbl.BackgroundTransparency = 1
    titleLbl.TextXAlignment = "Left"

    -- Real-time Monitor (Clock, FPS, Ping)
    local monitorLbl = Instance.new("TextLabel", topBar)
    monitorLbl.Size = UDim2.new(1, -120, 1, 0)
    monitorLbl.Position = UDim2.new(0, 110, 0, 0)
    monitorLbl.BackgroundTransparency = 1
    monitorLbl.Font = Enum.Font.Gotham
    monitorLbl.TextSize = 10
    monitorLbl.TextColor3 = Color3.fromRGB(150, 150, 150)
    monitorLbl.TextXAlignment = "Right"
    Instance.new("UIPadding", monitorLbl).PaddingRight = UDim.new(0, 15)

    task.spawn(function()
        while task.wait(0.5) do
            local fps = math.floor(1/RunService.RenderStepped:Wait())
            local ping = math.floor(Stats.Network.ServerStatsItem["Data Ping"]:GetValue())
            monitorLbl.Text = os.date("%X") .. " | " .. fps .. " FPS | " .. ping .. " MS"
        end
    end)

    -- Bottom Drag Handle
    local bottomDrag = Instance.new("Frame", main)
    bottomDrag.Size = UDim2.new(0, 150, 0, 4)
    bottomDrag.Position = UDim2.new(0.5, -75, 1, -15)
    bottomDrag.BackgroundColor3 = self.CurrentTheme.Border
    Instance.new("UICorner", bottomDrag)
    MakeDraggable(bottomDrag, main)

    -- Sidebar
    local sidebar = Instance.new("Frame", main)
    sidebar.Size = UDim2.new(0, 150, 1, -50)
    sidebar.Position = UDim2.new(0, 0, 0, 50)
    sidebar.BackgroundColor3 = self.CurrentTheme.Secondary
    sidebar.BorderSizePixel = 0
    Instance.new("UICorner", sidebar).CornerRadius = UDim.new(0, 12)

    local tabScroll = Instance.new("ScrollingFrame", sidebar)
    tabScroll.Size = UDim2.new(1, -10, 1, -20)
    tabScroll.Position = UDim2.new(0, 5, 0, 10)
    tabScroll.BackgroundTransparency = 1
    tabScroll.ScrollBarThickness = 0
    local tabLayout = Instance.new("UIListLayout", tabScroll)
    tabLayout.Padding = UDim.new(0, 5)

    -- Content Area
    local contentArea = Instance.new("Frame", main)
    contentArea.Size = UDim2.new(1, -160, 1, -60)
    contentArea.Position = UDim2.new(0, 155, 0, 55)
    contentArea.BackgroundTransparency = 1

    -- Toggle Button (Floating)
    local toggleBtn = Instance.new("TextButton", self.ScreenGui)
    toggleBtn.Size = UDim2.new(0, 45, 0, 45)
    toggleBtn.Position = UDim2.new(0.1, 0, 0.1, 0)
    toggleBtn.BackgroundColor3 = self.CurrentTheme.Accent
    toggleBtn.Text = "F"
    toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleBtn.Font = Enum.Font.GothamBold
    toggleBtn.TextSize = 20
    Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(0, 10)
    Instance.new("UIStroke", toggleBtn).Color = Color3.fromRGB(255, 255, 255)
    MakeDraggable(toggleBtn, toggleBtn)

    toggleBtn.MouseButton1Click:Connect(function()
        WindUI.Closed = not WindUI.Closed
        if WindUI.Closed then
            Tween(main, {Time = 0.4}, {Size = UDim2.new(0, 0, 0, 0)})
            task.delay(0.4, function() main.Visible = false end)
        else
            main.Visible = true
            Tween(main, {Time = 0.4, Style = Enum.EasingStyle.Back}, {Size = UDim2.new(0, 550, 0, 400)})
        end
    end)

    local Window = { Tabs = {}, CurrentTab = nil }

    function Window:CreateTab(name)
        local tabBtn = Instance.new("TextButton", tabScroll)
        tabBtn.Size = UDim2.new(1, 0, 0, 35)
        tabBtn.BackgroundColor3 = WindUI.CurrentTheme.Accent
        tabBtn.BackgroundTransparency = 1
        tabBtn.Text = name
        tabBtn.Font = WindUI.CurrentFont
        tabBtn.TextColor3 = WindUI.CurrentTheme.Text
        tabBtn.TextTransparency = 0.4
        tabBtn.TextSize = 13
        Instance.new("UICorner", tabBtn).CornerRadius = UDim.new(0, 6)

        local tabContent = Instance.new("ScrollingFrame", contentArea)
        tabContent.Size = UDim2.new(1, 0, 1, 0)
        tabContent.BackgroundTransparency = 1
        tabContent.Visible = false
        tabContent.ScrollBarThickness = 2
        tabContent.ScrollBarImageColor3 = WindUI.CurrentTheme.Accent
        local contentLayout = Instance.new("UIListLayout", tabContent)
        contentLayout.Padding = UDim.new(0, 8)
        contentLayout.HorizontalAlignment = "Center"

        local Tab = { Button = tabBtn, Content = tabContent }

        local function Activate()
            if Window.CurrentTab then
                Window.CurrentTab.Content.Visible = false
                Tween(Window.CurrentTab.Button, {}, {BackgroundTransparency = 1, TextTransparency = 0.4})
            end
            Window.CurrentTab = Tab
            tabContent.Visible = true
            Tween(tabBtn, {}, {BackgroundTransparency = 0.8, TextTransparency = 0})
        end

        tabBtn.MouseButton1Click:Connect(Activate)

        function Tab:CreateButton(text, callback)
            local b = Instance.new("TextButton", tabContent)
            b.Size = UDim2.new(0.95, 0, 0, 38)
            b.BackgroundColor3 = WindUI.CurrentTheme.Secondary
            b.Text = text
            b.Font = WindUI.CurrentFont
            b.TextColor3 = WindUI.CurrentTheme.Text
            b.TextSize = 13
            Instance.new("UICorner", b).CornerRadius = UDim.new(0, 8)
            Instance.new("UIStroke", b).Color = WindUI.CurrentTheme.Border
            b.MouseButton1Click:Connect(function()
                Tween(b, {Time = 0.1}, {BackgroundColor3 = WindUI.CurrentTheme.Accent})
                task.wait(0.1)
                Tween(b, {Time = 0.1}, {BackgroundColor3 = WindUI.CurrentTheme.Secondary})
                pcall(callback)
            end)
        end

        function Tab:CreateToggle(text, default, callback)
            local state = default
            local tBtn = Instance.new("TextButton", tabContent)
            tBtn.Size = UDim2.new(0.95, 0, 0, 45)
            tBtn.BackgroundColor3 = WindUI.CurrentTheme.Secondary
            tBtn.Text = ""
            Instance.new("UICorner", tBtn)
            
            local lbl = Instance.new("TextLabel", tBtn)
            lbl.Text = text; lbl.Size = UDim2.new(1, -60, 1, 0); lbl.Position = UDim2.new(0, 15, 0, 0)
            lbl.BackgroundTransparency = 1; lbl.Font = WindUI.CurrentFont; lbl.TextColor3 = WindUI.CurrentTheme.Text; lbl.TextXAlignment = "Left"

            local switch = Instance.new("Frame", tBtn)
            switch.Size = UDim2.new(0, 36, 0, 18); switch.Position = UDim2.new(1, -50, 0.5, -9)
            switch.BackgroundColor3 = state and WindUI.CurrentTheme.Accent or Color3.fromRGB(60, 60, 60)
            Instance.new("UICorner", switch)

            local knob = Instance.new("Frame", switch)
            knob.Size = UDim2.new(0, 14, 0, 14); knob.Position = state and UDim2.new(1, -16, 0.5, -7) or UDim2.new(0, 2, 0.5, -7)
            knob.BackgroundColor3 = Color3.fromRGB(255, 255, 255); Instance.new("UICorner", knob)

            tBtn.MouseButton1Click:Connect(function()
                state = not state
                Tween(switch, {}, {BackgroundColor3 = state and WindUI.CurrentTheme.Accent or Color3.fromRGB(60, 60, 60)})
                Tween(knob, {}, {Position = state and UDim2.new(1, -16, 0.5, -7) or UDim2.new(0, 2, 0.5, -7)})
                pcall(callback, state)
            end)
        end

        table.insert(Window.Tabs, Tab)
        if #Window.Tabs == 1 then Activate() end
        return Tab
    end

    return Window
end

-- // EXECUTION // --
local Win = WindUI:CreateWindow("fyor UI v1.2")
WindUI:Notify("System", "Library Loaded Successfully!", 3)

local Home = Win:CreateTab("Home")
Home:CreateButton("Copy JobID", function()
    setclipboard(game.JobId)
    WindUI:Notify("Success", "JobID copied!", 2)
end)

local Main = Win:CreateTab("Main")
Main:CreateToggle("Auto Farm", false, function(v)
    print("Farm status: ", v)
end)

return WindUI

